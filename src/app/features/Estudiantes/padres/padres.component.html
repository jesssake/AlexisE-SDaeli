<div class="layout" role="region" aria-label="Padres y chat del alumno">
  <!-- Columna izquierda: info del tutor -->
  <section class="info">
    <header class="info-head">
      <h1>Mis padres / tutor</h1>
      <p class="muted">
        AquÃ­ puedes ver los datos de tu tutor y chatear con Ã©l cuando lo
        autoricen.
      </p>
    </header>

    <div *ngIf="cargando()" class="skeleton">
      <div class="avatar sk"></div>
      <div class="lines">
        <span class="sk line"></span>
        <span class="sk line"></span>
        <span class="sk line short"></span>
      </div>
    </div>

    <div *ngIf="!cargando() && error()" class="state error">
      {{ error() }}
    </div>

    <div
      *ngIf="!cargando() && !error() && !tutorNombre() && !tutorCorreo()"
      class="state"
    >
      No se encontrÃ³ tu tutor registrado. Pregunta a tu maestro para que lo
      vincule en el sistema.
    </div>

    <div
      *ngIf="!cargando() && !error() && (tutorNombre() || tutorCorreo())"
      class="card"
    >
      <div class="card-main">
        <div class="avatar">
          <span>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§</span>
        </div>

        <div class="data">
          <div class="alumno">
            <span class="label">Alumno</span>
            <strong>{{ alumnoNombre() || 'Alumno' }}</strong>
          </div>

          <div class="tutor">
            <span class="label">Tutor</span>
            <strong>{{ tutorNombre() || 'Sin tutor' }}</strong>
          </div>

          <div class="correo" *ngIf="tutorCorreo()">
            <span class="label">Correo</span>
            <span>{{ tutorCorreo() }}</span>
          </div>
        </div>
      </div>

      <div class="card-actions">
        <button type="button" class="btn-chat" (click)="abrirChat()">
          ğŸ’¬ Abrir chat con mi tutor
        </button>
        <p class="hint">
          Usa este chat sÃ³lo para temas escolares y con supervisiÃ³n de un
          adulto.
        </p>
      </div>
    </div>
  </section>

  <!-- Columna derecha: panel de chat -->
  <aside
    class="panel"
    *ngIf="chatAbierto() && alumnoId()"
    role="dialog"
    aria-modal="true"
    [attr.aria-label]="tituloChat()"
  >
    <div class="panel-head">
      <strong>{{ tituloChat() }}</strong>
      <button
        type="button"
        class="btn-cerrar"
        (click)="cerrarChat()"
        aria-label="Cerrar chat"
      >
        âœ•
      </button>
    </div>

    <app-chat-panel
      [alumnoId]="alumnoId()!"
      [tutorId]="tutorId()"
      [titulo]="tituloChat()"
      [role]="'ALUMNO'"
      [floating]="false"
      (closed)="cerrarChat()"
    ></app-chat-panel>
  </aside>
</div>
