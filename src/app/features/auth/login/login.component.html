<div class="login-container fade-transition fade-in">
  <!-- Overlay de transici칩n -->
  <div class="transition-loading" *ngIf="isTransitioning" aria-live="polite" aria-busy="true">
    <div class="transition-spinner"></div>
    <div class="transition-text">{{ transitionMessage }}</div>
  </div>

  <!-- Part칤culas de transici칩n -->
  <div class="transition-particles" *ngIf="isTransitioning" aria-hidden="true">
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
  </div>

  <!-- Part칤culas de fondo -->
  <div class="background-particles" aria-hidden="true">
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
    <div class="particle"></div>
  </div>

  <!-- Header -->
  <div class="login-header">
    <h1>춰Bienvenidos!</h1>
    <p>Vamos a aprender y divertirnos 游꿀</p>
  </div>

  <!-- Errores generales -->
  <div class="alert error" *ngIf="errors['general'] as errGeneral" role="alert">
    {{ errGeneral }}
  </div>

  <!-- Formulario -->
  <form class="login-form" (ngSubmit)="submit()" #frm="ngForm" novalidate>
    <!-- Email -->
    <div class="form-group" [class.has-error]="!!errors['email']">
      <label for="email">Correo Electr칩nico</label>
      <input
        type="email"
        id="email"
        name="email"
        [(ngModel)]="model.email"
        placeholder="admin@escuela.com"
        (focus)="onEmailFocus()"
        (blur)="onEmailBlur()"
        required
        [disabled]="loading || isTransitioning"
        autocomplete="username"
        aria-required="true"
        [attr.aria-invalid]="!!errors['email']"
        [attr.aria-describedby]="errors['email'] ? 'email-error' : null"
      />
      <div class="field-error" *ngIf="errors['email']" id="email-error" role="alert">
        {{ errors['email'] }}
      </div>
    </div>

    <!-- Password -->
    <div class="form-group" [class.has-error]="!!errors['password']">
      <label for="password">Contrase침a</label>

      <div class="password-container">
        <input
          [type]="showPass ? 'text' : 'password'"
          id="password"
          name="password"
          [(ngModel)]="model.password"
          placeholder="Escribe tu contrase침a..."
          (focus)="onPasswordFocus()"
          (blur)="onPasswordBlur()"
          (input)="onPasswordInput()"
          required
          [disabled]="loading || isTransitioning"
          autocomplete="current-password"
          aria-required="true"
          [attr.aria-invalid]="!!errors['password']"
          [attr.aria-describedby]="errors['password'] ? 'password-error' : null"
        />

        <!-- Mono con transici칩n -->
        <div class="monkey-eye-container monkey-transition monkey-enter" *ngIf="showMonkey" aria-hidden="false">
          <button
            type="button"
            class="monkey-eye-button"
            (click)="togglePasswordVisibility()"
            [class.visible]="showPass"
            [attr.aria-pressed]="showPass"
            aria-label="Mostrar u ocultar contrase침a"
          >
            <span class="monkey-emoji">{{ monkeyEyes }}</span>
            <div class="speech-bubble" *ngIf="showSpeech">{{ monkeyMessage }}</div>
          </button>
        </div>
      </div>

      <div class="field-error" *ngIf="errors['password']" id="password-error" role="alert">
        {{ errors['password'] }}
      </div>

      <a href="#" class="recovery-link" (click)="openRecovery($event)">쯆lvidaste tu contrase침a?</a>
    </div>

    <!-- Bot칩n -->
    <button
      type="submit"
      class="login-btn"
      [disabled]="loading || isTransitioning || !model.email || !model.password"
    >
      <div class="btn-content">
        <span *ngIf="!loading">游꿡 ENTRAR A LA AVENTURA</span>
        <span *ngIf="loading" class="loading-content">
          <span class="loading-spinner" aria-hidden="true"></span>
          Cargando...
        </span>
      </div>
    </button>
  </form>

  <!-- Footer -->
  <div class="footer-links">
    <a (click)="goToRegister()" [class.disabled]="isTransitioning" style="cursor: pointer;">
      쯅o tienes cuenta? Registro a tu ni침o
    </a>
  </div>
</div>
